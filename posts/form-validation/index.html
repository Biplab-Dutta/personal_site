<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Form Validation in Flutter using flutter_bloc and Functional Programming (Either)—A Proper Way" /><meta name="author" content="Biplab Dutta" /><meta property="og:locale" content="en" /><meta name="description" content="Dealing with forms is a very common task that we encounter as mobile application developers. With forms come form validation. It is necessary to show relevant warnings to the users when they don’t fill-up the form as they were supposed to. In order to do so, we need to write certain validation logic. However, the declarative UI approach in flutter results in many developers writing their validation logic right in the UI code which is BAD, VERY BAD." /><meta property="og:description" content="Dealing with forms is a very common task that we encounter as mobile application developers. With forms come form validation. It is necessary to show relevant warnings to the users when they don’t fill-up the form as they were supposed to. In order to do so, we need to write certain validation logic. However, the declarative UI approach in flutter results in many developers writing their validation logic right in the UI code which is BAD, VERY BAD." /><link rel="canonical" href="https://biplabdutta.com.np/posts/form-validation/" /><meta property="og:url" content="https://biplabdutta.com.np/posts/form-validation/" /><meta property="og:site_name" content="Biplab Dutta" /><meta property="og:image" content="https://raw.githubusercontent.com/Biplab-Dutta/personal_site/main/preview_images/form_validation.jpg" /><meta property="og:image:alt" content="Preview Image Credit - DorMoshe" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-15T15:00:00+05:45" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://raw.githubusercontent.com/Biplab-Dutta/personal_site/main/preview_images/form_validation.jpg" /><meta name="twitter:image:alt" content="Preview Image Credit - DorMoshe" /><meta property="twitter:title" content="Form Validation in Flutter using flutter_bloc and Functional Programming (Either)—A Proper Way" /><meta name="twitter:site" content="@b_plab98" /><meta name="twitter:creator" content="@b_plab98" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Biplab Dutta","url":"https://twitter.com/b_plab98"},"dateModified":"2022-10-09T19:44:16+05:45","datePublished":"2022-05-15T15:00:00+05:45","description":"Dealing with forms is a very common task that we encounter as mobile application developers. With forms come form validation. It is necessary to show relevant warnings to the users when they don’t fill-up the form as they were supposed to. In order to do so, we need to write certain validation logic. However, the declarative UI approach in flutter results in many developers writing their validation logic right in the UI code which is BAD, VERY BAD.","headline":"Form Validation in Flutter using flutter_bloc and Functional Programming (Either)—A Proper Way","image":{"alt":"Preview Image Credit - DorMoshe","url":"https://raw.githubusercontent.com/Biplab-Dutta/personal_site/main/preview_images/form_validation.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://biplabdutta.com.np/posts/form-validation/"},"url":"https://biplabdutta.com.np/posts/form-validation/"}</script><title>Form Validation in Flutter using flutter_bloc and Functional Programming (Either)—A Proper Way | Biplab Dutta</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Biplab Dutta"><meta name="application-name" content="Biplab Dutta"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/63902683?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Biplab Dutta</a></div><div class="site-subtitle font-italic">Flutter Developer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Biplab-Dutta" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/b_plab98" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/biplab-dutta-43774717a" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://stackoverflow.com/users/10167900/biplab-dutta" aria-label="stack-overflow" target="_blank" rel="noopener"> <i class="fab fa-stack-overflow"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Form Validation in Flutter using flutter_bloc and Functional Programming (Either)—A Proper Way</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Form Validation in Flutter using flutter_bloc and Functional Programming (Either)—A Proper Way</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1652606100" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 15, 2022 </em> </span> <span> Updated <em class="" data-ts="1665323956" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 9, 2022 </em> </span><div class="mt-3 mb-3"> <img data-src="https://raw.githubusercontent.com/Biplab-Dutta/personal_site/main/preview_images/form_validation.jpg" class="preview-img bg" alt="Preview Image Credit - DorMoshe" data-proofer-ignore><figcaption class="text-center pt-2 pb-2">Preview Image Credit - DorMoshe</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/b_plab98">Biplab Dutta</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2393 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><p>Dealing with forms is a very common task that we encounter as mobile application developers. With forms come form validation. It is necessary to show relevant warnings to the users when they don’t fill-up the form as they were supposed to. In order to do so, we need to write certain validation logic. However, the declarative UI approach in flutter results in many developers writing their validation logic right in the UI code which is <strong>BAD, VERY BAD</strong>.</p><p>Are you writing your validation logic in the UI? If yes, then this article is for you. I will be talking about a proper way how can deal with form validation that doesn’t just work but is architecturally clean and reasonable.</p><blockquote class="prompt-info"><div><p><em>The approach that I will be sharing and which I often use in my personal projects is inspired by <a href="https://www.youtube.com/c/ResoCoder">Reso Coder</a>’s tutorial on <a href="https://www.youtube.com/playlist?list=PLB6lc7nQ1n4iS5p-IezFFgqP6YvAJy84U">Domain-driven design</a>.</em></p></div></blockquote><h2 id="table-of-contents"><span class="mr-2">Table of Contents</span><a href="#table-of-contents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="#form-validation-in-the-ui-bad-approach">Form Validation in the UI (Bad Approach)</a><li><a href="#domain-layer">Domain Layer</a><li><a href="#presentation-layer">Presentation Layer</a><ul><li><a href="#event-class">Event class</a><li><a href="#state-class">State class</a><li><a href="#bloc">Bloc</a></ul><li><a href="#conclusion">Conclusion</a><li><a href="#credit">Credit</a></ul><h2 id="form-validation-in-the-ui-bad-approach"><span class="mr-2">Form Validation in the UI (Bad Approach)</span><a href="#form-validation-in-the-ui-bad-approach" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s take a look at a snippet that validates a form with the validation logic in the UI.</p><div class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="Dart"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">MyCustomForm</span> <span class="kd">extends</span> <span class="n">StatefulWidget</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="n">MyCustomForm</span><span class="p">({</span><span class="k">super</span><span class="o">.</span><span class="na">key</span><span class="p">});</span>

  <span class="nd">@override</span>
  <span class="n">MyCustomFormState</span> <span class="n">createState</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">MyCustomFormState</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">MyCustomFormState</span> <span class="kd">extends</span> <span class="n">State</span><span class="p">&lt;</span><span class="n">MyCustomForm</span><span class="p">&gt;</span> <span class="p">{</span>
  
  <span class="kd">final</span> <span class="n">_formKey</span> <span class="o">=</span> <span class="n">GlobalKey</span><span class="p">&lt;</span><span class="n">FormState</span><span class="p">&gt;();</span>

  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">Form</span><span class="p">(</span>
      <span class="nl">key:</span> <span class="n">_formKey</span><span class="p">,</span>
      <span class="nl">child:</span> <span class="n">Column</span><span class="p">(</span>
        <span class="nl">crossAxisAlignment:</span> <span class="n">CrossAxisAlignment</span><span class="o">.</span><span class="na">start</span><span class="p">,</span>
        <span class="nl">children:</span> <span class="p">[</span>
          <span class="n">TextFormField</span><span class="p">(</span>
            <span class="nl">validator:</span> <span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">value</span><span class="o">.</span><span class="na">isEmpty</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">// Validation Logic</span>
                <span class="k">return</span> <span class="s">'Please enter some text'</span><span class="p">;</span>
              <span class="p">}</span>
              <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">},</span>
          <span class="p">),</span>
          <span class="n">Padding</span><span class="p">(</span>
            <span class="nl">padding:</span> <span class="kd">const</span> <span class="n">EdgeInsets</span><span class="o">.</span><span class="na">symmetric</span><span class="p">(</span><span class="nl">vertical:</span> <span class="mf">16.0</span><span class="p">),</span>
            <span class="nl">child:</span> <span class="n">ElevatedButton</span><span class="p">(</span>
              <span class="nl">onPressed:</span> <span class="p">()</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">_formKey</span><span class="o">.</span><span class="na">currentState</span><span class="o">!.</span><span class="na">validate</span><span class="p">())</span> <span class="p">{</span>
                  <span class="n">ScaffoldMessenger</span><span class="o">.</span><span class="na">of</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="na">showSnackBar</span><span class="p">(</span>
                    <span class="kd">const</span> <span class="n">SnackBar</span><span class="p">(</span><span class="nl">content:</span> <span class="n">Text</span><span class="p">(</span><span class="s">'Processing Data'</span><span class="p">)),</span>
                  <span class="p">);</span>
                <span class="p">}</span>
              <span class="p">},</span>
              <span class="nl">child:</span> <span class="kd">const</span> <span class="n">Text</span><span class="p">(</span><span class="s">'Submit'</span><span class="p">),</span>
            <span class="p">),</span>
          <span class="p">),</span>
        <span class="p">],</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>As you can see, this is how someone would perform form validation with all validation logic right in the UI. It definitely works as intended but it is bad from an architectural point of view.</p><blockquote class="prompt-info"><div><p><em>Many might argue that for something as simple as this is, it is not necessary to be concerned about architecture and do it as shown above but as developers, we should have developer ethics and we should do things in the right way. There should never be room for a simple workaround.</em></p></div></blockquote><p>Now, if you are further reading this article, I assume you agree with me. Now let’s take a look at how to perform form validation — the right way.</p><p>Before anything, let’s add some dependencies and dev-dependencies that we will require for this project. You will be needing <a href="https://pub.dev/packages/dartz">dartz</a>, <a href="https://pub.dev/packages/equatable">equatable</a>, <a href="https://pub.dev/packages/flutter_bloc">flutter_bloc</a>, and <a href="https://pub.dev/packages/freezed_annotation">freezed_annotation</a> as your dependencies. Also, <a href="https://pub.dev/packages/build_runner">build_runner</a> and <a href="https://pub.dev/packages/freezed">freezed</a> as your dev-dependencies.</p><h2 id="domain-layer"><span class="mr-2">Domain Layer</span><a href="#domain-layer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let’s have a look at what we often see in simple projects where a <code class="language-plaintext highlighter-rouge">login()</code> method is implemented.</p><div class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="Dart"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">login</span><span class="p">({</span>
   <span class="kd">required</span> <span class="kt">String</span> <span class="n">email</span><span class="p">,</span>
   <span class="kd">required</span> <span class="kt">String</span> <span class="n">password</span><span class="p">,</span>
<span class="p">})</span> <span class="kd">async</span> <span class="p">{}</span>
</pre></table></code></div></div><p>This is generally the method signature for <code class="language-plaintext highlighter-rouge">login()</code> method. While we can definitely do something with the method shown above, it won’t prevent some developers in the future from messing up. For example, one can call the method as</p><div class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="Dart"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">await</span> <span class="nf">login</span><span class="p">(</span>
   <span class="nl">email:</span> <span class="s">"email123"</span><span class="p">,</span> 
   <span class="nl">password:</span> <span class="s">"pw"</span><span class="p">,</span>
<span class="p">);</span>
</pre></table></code></div></div><p>Syntactically, it is fine. There’s nothing wrong with what we have done here. But logically, the email can’t just be <code class="language-plaintext highlighter-rouge">email123</code> and the password shouldn’t just be two characters long. So, how can we deal with issues as such, enforcing us to pass only email-like input to email and the same for password?</p><p>And the answer to that is creating <code class="language-plaintext highlighter-rouge">EmailAddress</code> and <code class="language-plaintext highlighter-rouge">Password</code> class. Having a class for each attribute will allow us to write some custom logic as well which we will see in a moment.</p><div file="email_address.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="email_address.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">EmailAddress</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="n">EmailAddress</span><span class="p">(</span><span class="k">this</span><span class="o">.</span><span class="na">value</span><span class="p">);</span>
  <span class="kd">final</span> <span class="kt">String</span> <span class="n">value</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now, we have a <code class="language-plaintext highlighter-rouge">EmailAddress</code> class with a value property of String type. But this is no different from what I showed earlier because the property <code class="language-plaintext highlighter-rouge">value</code> is still a <code class="language-plaintext highlighter-rouge">String</code> and any string can be passed to it. If we think about the property <code class="language-plaintext highlighter-rouge">value</code> , then it can either be a legitimate String value or an illegitimate String. For example, if the property value for <code class="language-plaintext highlighter-rouge">EmailAddress</code> class is <code class="language-plaintext highlighter-rouge">‘abc@gmail.com’</code> then, this is a legitimate string value for email. But if the property <code class="language-plaintext highlighter-rouge">value</code> is something like <code class="language-plaintext highlighter-rouge">‘abc’</code> then, it is an illegitimate string value.</p><p>Now, what data type can we use for the property value so as to tell that it can have either a legitimate value or an illegitimate value? And the answer to that will be using <strong><a href="https://medium.com/disney-streaming/option-either-state-and-io-imperative-programming-in-a-functional-world-8e176049af81">Either</a></strong> type from package <a href="https://pub.dev/packages/dartz">dartz</a>.</p><blockquote class="prompt-tip"><div><p><em><code class="language-plaintext highlighter-rouge">Either</code> is an entity whose value can be of two different types, called left and right. By convention, <code class="language-plaintext highlighter-rouge">Right</code> is for the success case and <code class="language-plaintext highlighter-rouge">Left</code> is for the error one. It’s a common pattern in the functional community.</em></p></div></blockquote><div file="email_address.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="email_address.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">EmailAddress</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="n">EmailAddress</span><span class="p">(</span><span class="k">this</span><span class="o">.</span><span class="na">value</span><span class="p">);</span>
  <span class="kd">final</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">ValueFailure</span><span class="p">,</span> <span class="kt">String</span><span class="p">&gt;</span> <span class="n">value</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now, using <code class="language-plaintext highlighter-rouge">Either</code> type, we can tell the compiler that value can possibly have one out of two types. In this case, the property value can either be of a <code class="language-plaintext highlighter-rouge">ValueFailure</code> type or a <code class="language-plaintext highlighter-rouge">String</code> type.</p><p>Now, what is a <code class="language-plaintext highlighter-rouge">ValueFailure</code>? <code class="language-plaintext highlighter-rouge">ValueFailure</code> is simply a union to represent an invalid email string. We can create unions using <a href="https://pub.dev/packages/freezed">freezed</a> package.</p><div file="value_failure.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="value_failure.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kn">part</span> <span class="s">'value_failure.freezed.dart'</span><span class="o">;</span>

<span class="nd">@freezed</span>
<span class="kd">class</span> <span class="nc">ValueFailure</span> <span class="k">with</span> <span class="n">_$ValueFailure</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">ValueFailure</span><span class="o">.</span><span class="na">invalidEmail</span><span class="p">({</span>
    <span class="kd">required</span> <span class="kt">String</span> <span class="n">failedValue</span><span class="p">,</span>
  <span class="p">})</span> <span class="o">=</span> <span class="n">_InvalidEmail</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now, run the command</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>flutter pub run build_runner watch <span class="nt">--delete-conflicting-outputs</span>
</pre></table></code></div></div><p>This should generate a bunch of code and all the errors should be gone.</p><p>Now, if we take a look at our <code class="language-plaintext highlighter-rouge">EmailAddress</code> class, everything looks fine except for the validation logic. We somehow need to add the validation logic while we are in the domain layer. It would be great if we could run the validation as soon as <code class="language-plaintext highlighter-rouge">EmailAddress</code> class was instantiated. Fortunately, we can do so with the help of a <strong>factory constructor</strong>. First, we will create a private constructor so that it can’t be used to create an instance of <code class="language-plaintext highlighter-rouge">EmailAddress</code> class. And then add a factory constructor which will act as a default constructor. The factory constructor will take in a string as an input which will undergo validation.</p><blockquote class="prompt-tip"><div><p><em>We shall be using Regex to perform email validation.</em></p></div></blockquote><div file="email_address.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="email_address.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">EmailAddress</span> <span class="kd">extends</span> <span class="n">Equatable</span> <span class="p">{</span>
  <span class="kd">factory</span> <span class="n">EmailAddress</span><span class="p">(</span><span class="kt">String</span> <span class="n">input</span><span class="p">)</span> <span class="o">=</span><span class="p">&gt;</span>
      <span class="n">EmailAddress</span><span class="o">.</span><span class="na">_</span><span class="p">(</span><span class="n">_validateEmailAddress</span><span class="p">(</span><span class="n">input</span><span class="p">));</span>

  <span class="kd">const</span> <span class="n">EmailAddress</span><span class="o">.</span><span class="na">_</span><span class="p">(</span><span class="k">this</span><span class="o">.</span><span class="na">value</span><span class="p">);</span>

  <span class="kd">final</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">ValueFailure</span><span class="p">,</span> <span class="kt">String</span><span class="p">&gt;</span> <span class="n">value</span><span class="p">;</span>

  <span class="nd">@override</span>
  <span class="kt">List</span><span class="p">&lt;</span><span class="kt">Object</span><span class="o">?</span><span class="p">&gt;</span> <span class="kd">get</span> <span class="n">props</span> <span class="o">=</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">value</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">Either</span><span class="p">&lt;</span><span class="n">ValueFailure</span><span class="p">,</span> <span class="kt">String</span><span class="p">&gt;</span> <span class="n">_validateEmailAddress</span><span class="p">(</span><span class="kt">String</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="n">emailRegex</span> <span class="o">=</span>
      <span class="sx">r""</span><span class="s">"^[a-zA-Z0-9.a-zA-Z0-9.!#</span><span class="err">$</span><span class="s">%&amp;'*+-/=?^_`{|}~]+@[a-zA-Z0-9]+</span><span class="err">\</span><span class="s">.[a-zA-Z]+"""</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">RegExp</span><span class="p">(</span><span class="n">emailRegex</span><span class="p">)</span><span class="o">.</span><span class="na">hasMatch</span><span class="p">(</span><span class="n">input</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">right</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">left</span><span class="p">(</span>
      <span class="n">ValueFailure</span><span class="o">.</span><span class="na">invalidEmail</span><span class="p">(</span><span class="nl">failedValue:</span> <span class="n">input</span><span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We can see that if we try to do something like</p><div class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="Dart"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">var</span> <span class="n">email</span> <span class="o">=</span> <span class="n">EmailAddress</span><span class="p">(</span><span class="s">'abc@gmail.com'</span><span class="p">);</span>
</pre></table></code></div></div><p>then immediately, the passed in string will go through our validation logic and either return <code class="language-plaintext highlighter-rouge">ValueFailure</code> or <code class="language-plaintext highlighter-rouge">String</code>. Also, notice that we are extending our <code class="language-plaintext highlighter-rouge">EmailAddress</code> class with <a href="https://pub.dev/packages/equatable">Equatable</a> to enforce value equality over reference equality which requires us to override the <code class="language-plaintext highlighter-rouge">props</code> getter.</p><p>And this is it.</p><p>Now, we do the same thing for the <code class="language-plaintext highlighter-rouge">Password</code> class too. The validation logic will only differ and the rest remains the same. Also, we will need to add another redirecting constructor in our <code class="language-plaintext highlighter-rouge">ValueFailure</code> union class. Therefore, our <code class="language-plaintext highlighter-rouge">value_failure.dart</code> and <code class="language-plaintext highlighter-rouge">password.dart</code> would look like this:</p><div file="value_failure.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="value_failure.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="s">'package:freezed_annotation/freezed_annotation.dart'</span><span class="o">;</span>

<span class="kn">part</span> <span class="s">'value_failure.freezed.dart'</span><span class="o">;</span>

<span class="nd">@freezed</span>
<span class="kd">class</span> <span class="nc">ValueFailure</span> <span class="k">with</span> <span class="n">_$ValueFailure</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">ValueFailure</span><span class="o">.</span><span class="na">invalidEmail</span><span class="p">({</span>
    <span class="kd">required</span> <span class="kt">String</span> <span class="n">failedValue</span><span class="p">,</span>
  <span class="p">})</span> <span class="o">=</span> <span class="n">_InvalidEmail</span><span class="p">;</span>

  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">ValueFailure</span><span class="o">.</span><span class="na">shortPassword</span><span class="p">({</span>
    <span class="kd">required</span> <span class="kt">String</span> <span class="n">failedValue</span><span class="p">,</span>
  <span class="p">})</span> <span class="o">=</span> <span class="n">_Password</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><div file="password.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="password.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">Password</span> <span class="kd">extends</span> <span class="n">Equatable</span> <span class="p">{</span>
  <span class="kd">factory</span> <span class="n">Password</span><span class="p">(</span><span class="kt">String</span> <span class="n">input</span><span class="p">)</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">Password</span><span class="o">.</span><span class="na">_</span><span class="p">(</span><span class="n">_validatePassword</span><span class="p">(</span><span class="n">input</span><span class="p">));</span>

  <span class="kd">const</span> <span class="n">Password</span><span class="o">.</span><span class="na">_</span><span class="p">(</span><span class="k">this</span><span class="o">.</span><span class="na">value</span><span class="p">);</span>

  <span class="kd">final</span> <span class="n">Either</span><span class="p">&lt;</span><span class="n">ValueFailure</span><span class="p">,</span> <span class="kt">String</span><span class="p">&gt;</span> <span class="n">value</span><span class="p">;</span>

  <span class="nd">@override</span>
  <span class="kt">List</span><span class="p">&lt;</span><span class="kt">Object</span><span class="o">?</span><span class="p">&gt;</span> <span class="kd">get</span> <span class="n">props</span> <span class="o">=</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">value</span><span class="p">];</span>
<span class="p">}</span>

<span class="n">Either</span><span class="p">&lt;</span><span class="n">ValueFailure</span><span class="p">,</span> <span class="kt">String</span><span class="p">&gt;</span> <span class="n">_validatePassword</span><span class="p">(</span><span class="kt">String</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">input</span><span class="o">.</span><span class="na">length</span> <span class="p">&gt;</span><span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">right</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">left</span><span class="p">(</span>
      <span class="n">ValueFailure</span><span class="o">.</span><span class="na">shortPassword</span><span class="p">(</span><span class="nl">failedValue:</span> <span class="n">input</span><span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="presentation-layer"><span class="mr-2">Presentation Layer</span><a href="#presentation-layer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now, we will begin working with our presentation layer. Let me show you the final result of our application.</p><p><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 500'%3E%3C/svg%3E" data-src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/796f898wzkv7fxxde3bz.gif" alt="flutter form validation demo" width="300" height="500" data-proofer-ignore></p><p>We will begin by creating our bloc.</p><h3 id="event-class"><span class="mr-2">Event class</span><a href="#event-class" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Considering the events or actions that users can perform to interact with the UI, the events can be</p><ul><li><p><strong>EmailChanged</strong> (when the user adds an input character to the email text field)</p><li><p><strong>PasswordChanged</strong> (when the user adds an input character to the password text field)</p><li><p><strong>ObscurePasswordToggled</strong> (when the user taps on the show password or hide password option in the password text field)</p><li><p><strong>LoginSubmitted</strong> (when the user taps on the login button)</p></ul><p>We will be creating a union class to represent events in our project.</p><div file="login_form_event.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="login_form_event.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">part of</span> <span class="s">'login_form_bloc.dart'</span><span class="o">;</span>

<span class="nd">@freezed</span>
<span class="kd">class</span> <span class="nc">LoginFormEvent</span> <span class="k">with</span> <span class="n">_$LoginFormEvent</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">LoginFormEvent</span><span class="o">.</span><span class="na">emailChanged</span><span class="p">(</span><span class="kt">String</span> <span class="n">emailString</span><span class="p">)</span> <span class="o">=</span> <span class="n">_EmailChanged</span><span class="p">;</span>

  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">LoginFormEvent</span><span class="o">.</span><span class="na">passwordChanged</span><span class="p">(</span><span class="kt">String</span> <span class="n">passwordString</span><span class="p">)</span> <span class="o">=</span>
      <span class="n">_PasswordChanged</span><span class="p">;</span>

  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">LoginFormEvent</span><span class="o">.</span><span class="na">obscurePasswordToggled</span><span class="p">()</span> <span class="o">=</span>
      <span class="n">_ObscurePasswordToggled</span><span class="p">;</span>

  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">LoginFormEvent</span><span class="o">.</span><span class="na">loginSubmitted</span><span class="p">()</span> <span class="o">=</span> <span class="n">_LoginSubmitted</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="state-class"><span class="mr-2">State class</span><a href="#state-class" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>What field should be present in the state class? We need to pass back the validated email and password to our UI. Also, on pressing the login button, a loading indicator appears until a response is received from the backend. So, we will need a <code class="language-plaintext highlighter-rouge">isSubmitting</code> <code class="language-plaintext highlighter-rouge">boolean</code> field that will be false by default. We don’t want the validation logic to kick in as soon as our app starts. Only once the login button is pressed, and if the email and password combination is invalid then we want the warnings to begin getting displayed. So, we also need a <code class="language-plaintext highlighter-rouge">showErrorMessage</code> <code class="language-plaintext highlighter-rouge">boolean</code> field that will be false by default. We also have a <strong><em>show/hide password</em></strong> option and the password will remain hidden (obscured) by default. So, we need an <code class="language-plaintext highlighter-rouge">obscurePassword</code> <code class="language-plaintext highlighter-rouge">boolean</code> field which will be true by default. After tapping on login, we will either succeed or fail. In this demo, we will show a snack bar if we log in when having a valid email and password. In a real-world application, you would show a snack bar with a proper message if the user is unable to log in or navigate to the home screen if login is successful. Since we will either succeed or fail the login process, we will need an <code class="language-plaintext highlighter-rouge">authSuccessOrFailure</code> <code class="language-plaintext highlighter-rouge">Either&lt;AuthFailure, Unit&gt;?</code> field. It is a nullable field because as the app starts we can’t tell if the login process is successful or not. So, if the <code class="language-plaintext highlighter-rouge">authSuccessOrFailure</code> is null that means we haven’t tried logging in yet. <code class="language-plaintext highlighter-rouge">Unit</code> is a data type that comes from <a href="https://pub.dev/packages/dartz">dartz</a> package and is equivalent to <code class="language-plaintext highlighter-rouge">void</code>.</p><div file="login_form_state.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="login_form_state.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kn">part of</span> <span class="s">'login_form_bloc.dart'</span><span class="o">;</span>

<span class="nd">@freezed</span>
<span class="kd">class</span> <span class="nc">LoginFormState</span> <span class="k">with</span> <span class="n">_$LoginFormState</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">LoginFormState</span><span class="p">({</span>
    <span class="kd">required</span> <span class="n">EmailAddress</span> <span class="n">emailAddress</span><span class="p">,</span>
    <span class="kd">required</span> <span class="n">Password</span> <span class="n">password</span><span class="p">,</span>
    <span class="nd">@Default</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="kt">bool</span> <span class="n">isSubmitting</span><span class="p">,</span>
    <span class="nd">@Default</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span> <span class="kt">bool</span> <span class="n">showErrorMessage</span><span class="p">,</span>
    <span class="nd">@Default</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="kt">bool</span> <span class="n">obscurePassword</span><span class="p">,</span>
    <span class="n">Either</span><span class="p">&lt;</span><span class="n">AuthFailure</span><span class="p">,</span> <span class="n">Unit</span><span class="p">&gt;</span><span class="o">?</span> <span class="n">authFailureOrSuccess</span><span class="p">,</span>
    <span class="c1">// Unit comes from Dartz package and is equivalent to void.</span>
  <span class="p">})</span> <span class="o">=</span> <span class="n">_LoginFormState</span><span class="p">;</span>

  <span class="kd">factory</span> <span class="n">LoginFormState</span><span class="o">.</span><span class="na">initial</span><span class="p">()</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">LoginFormState</span><span class="p">(</span>
        <span class="nl">emailAddress:</span> <span class="n">EmailAddress</span><span class="p">(</span><span class="s">''</span><span class="p">),</span>
        <span class="nl">password:</span> <span class="n">Password</span><span class="p">(</span><span class="s">''</span><span class="p">),</span>
      <span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">AuthFailure</code> is also a union class to represent authentication failure and because the authentication process might fail because of several reasons, we are using a union class.</p><div file="auth_failure.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="auth_failure.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="kn">part</span> <span class="s">'auth_failure.freezed.dart'</span><span class="o">;</span>

<span class="nd">@freezed</span>
<span class="kd">class</span> <span class="nc">AuthFailure</span> <span class="k">with</span> <span class="n">_$AuthFailure</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">AuthFailure</span><span class="o">.</span><span class="na">invalidEmailAndPasswordCombination</span><span class="p">()</span> <span class="o">=</span>
      <span class="n">_InvalidEmailAndPasswordCombination</span><span class="p">;</span>
  <span class="kd">const</span> <span class="kd">factory</span> <span class="n">AuthFailure</span><span class="o">.</span><span class="na">serverError</span><span class="p">()</span> <span class="o">=</span> <span class="n">_ServerError</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><blockquote class="prompt-tip"><div><p><em>Since we ran the <strong>build_runner watch</strong> command earlier, we needn’t run the build command again. For some reason, if the build_runner watch command has stopped running, you will need to re-run the command.</em></p></div></blockquote><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>flutter pub run build_runner watch <span class="nt">--delete-conflicting-outputs</span>
</pre></table></code></div></div><h3 id="bloc"><span class="mr-2">Bloc</span><a href="#bloc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is where the presentation logic is located.</p><div file="login_form_bloc.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="login_form_bloc.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre><td class="rouge-code"><pre><span class="kn">part</span> <span class="s">'login_form_bloc.freezed.dart'</span><span class="o">;</span>
<span class="kn">part</span> <span class="s">'login_form_event.dart'</span><span class="o">;</span>
<span class="kn">part</span> <span class="s">'login_form_state.dart'</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">LoginFormBloc</span> <span class="kd">extends</span> <span class="n">Bloc</span><span class="p">&lt;</span><span class="n">LoginFormEvent</span><span class="p">,</span> <span class="n">LoginFormState</span><span class="p">&gt;</span> <span class="p">{</span>
  <span class="n">LoginFormBloc</span><span class="p">()</span> <span class="o">:</span> <span class="k">super</span><span class="p">(</span><span class="n">LoginFormState</span><span class="o">.</span><span class="na">initial</span><span class="p">())</span> <span class="p">{</span>
    <span class="kd">on</span><span class="p">&lt;</span><span class="n">LoginFormEvent</span><span class="p">&gt;(</span>
      <span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">emit</span><span class="p">)</span> <span class="kd">async</span> <span class="p">{</span>
        <span class="k">await</span> <span class="n">event</span><span class="o">.</span><span class="na">when</span><span class="p">&lt;</span><span class="n">FutureOr</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;&gt;(</span>
          <span class="nl">emailChanged:</span> <span class="p">(</span><span class="n">emailString</span><span class="p">)</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">_onEmailChanged</span><span class="p">(</span><span class="n">emit</span><span class="p">,</span> <span class="n">emailString</span><span class="p">),</span>
          <span class="nl">passwordChanged:</span> <span class="p">(</span><span class="n">passwordString</span><span class="p">)</span> <span class="o">=</span><span class="p">&gt;</span>
              <span class="n">_onPasswordChanged</span><span class="p">(</span><span class="n">emit</span><span class="p">,</span> <span class="n">passwordString</span><span class="p">),</span>
          <span class="nl">obscurePasswordToggled:</span> <span class="p">()</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">_onObscurePasswordToggled</span><span class="p">(</span><span class="n">emit</span><span class="p">),</span>
          <span class="nl">loginSubmitted:</span> <span class="p">()</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">_onLoginSubmitted</span><span class="p">(</span><span class="n">emit</span><span class="p">),</span>
        <span class="p">);</span>
      <span class="p">},</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">void</span> <span class="n">_onEmailChanged</span><span class="p">(</span><span class="n">Emitter</span><span class="p">&lt;</span><span class="n">LoginFormState</span><span class="p">&gt;</span> <span class="n">emit</span><span class="p">,</span> <span class="kt">String</span> <span class="n">emailString</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">emit</span><span class="p">(</span>
      <span class="n">state</span><span class="o">.</span><span class="na">copyWith</span><span class="p">(</span>
        <span class="nl">emailAddress:</span> <span class="n">EmailAddress</span><span class="p">(</span><span class="n">emailString</span><span class="p">),</span>
        <span class="nl">authFailureOrSuccess:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">void</span> <span class="n">_onPasswordChanged</span><span class="p">(</span><span class="n">Emitter</span><span class="p">&lt;</span><span class="n">LoginFormState</span><span class="p">&gt;</span> <span class="n">emit</span><span class="p">,</span> <span class="kt">String</span> <span class="n">passwordString</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">emit</span><span class="p">(</span>
      <span class="n">state</span><span class="o">.</span><span class="na">copyWith</span><span class="p">(</span>
        <span class="nl">password:</span> <span class="n">Password</span><span class="p">(</span><span class="n">passwordString</span><span class="p">),</span>
        <span class="nl">authFailureOrSuccess:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">void</span> <span class="n">_onObscurePasswordToggled</span><span class="p">(</span><span class="n">Emitter</span><span class="p">&lt;</span><span class="n">LoginFormState</span><span class="p">&gt;</span> <span class="n">emit</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">emit</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="na">copyWith</span><span class="p">(</span><span class="nl">obscurePassword:</span> <span class="o">!</span><span class="n">state</span><span class="o">.</span><span class="na">obscurePassword</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">_onLoginSubmitted</span><span class="p">(</span><span class="n">Emitter</span><span class="p">&lt;</span><span class="n">LoginFormState</span><span class="p">&gt;</span> <span class="n">emit</span><span class="p">)</span> <span class="kd">async</span> <span class="p">{</span>
    <span class="kd">final</span> <span class="n">isEmailValid</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="na">emailAddress</span><span class="o">.</span><span class="na">value</span><span class="o">.</span><span class="na">isRight</span><span class="p">();</span>
    <span class="kd">final</span> <span class="n">isPasswordValid</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="na">password</span><span class="o">.</span><span class="na">value</span><span class="o">.</span><span class="na">isRight</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">isEmailValid</span> <span class="o">&amp;&amp;</span> <span class="n">isPasswordValid</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">emit</span><span class="p">(</span>
        <span class="n">state</span><span class="o">.</span><span class="na">copyWith</span><span class="p">(</span>
          <span class="nl">isSubmitting:</span> <span class="kc">true</span><span class="p">,</span>
          <span class="nl">authFailureOrSuccess:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="p">),</span>
      <span class="p">);</span>

      <span class="c1">// Perform network request to get a token.</span>

      <span class="k">await</span> <span class="n">Future</span><span class="o">.</span><span class="na">delayed</span><span class="p">(</span><span class="kd">const</span> <span class="n">Duration</span><span class="p">(</span><span class="nl">seconds:</span> <span class="mi">1</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">emit</span><span class="p">(</span>
      <span class="n">state</span><span class="o">.</span><span class="na">copyWith</span><span class="p">(</span>
        <span class="nl">isSubmitting:</span> <span class="kc">false</span><span class="p">,</span>
        <span class="nl">showErrorMessage:</span> <span class="kc">true</span><span class="p">,</span>

        <span class="c1">// Depending on the response received from the server after loggin in,</span>
        <span class="c1">// emit proper authFailureOrSuccess.</span>

        <span class="c1">// For now we will just see if the email and password were valid or not</span>
        <span class="c1">// and accordingly set authFailureOrSuccess' value.</span>

        <span class="nl">authFailureOrSuccess:</span>
            <span class="p">(</span><span class="n">isEmailValid</span> <span class="o">&amp;&amp;</span> <span class="n">isPasswordValid</span><span class="p">)</span> <span class="o">?</span> <span class="n">right</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span> <span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now all that is left is to create two TextFields and wrap them with the BlocBuilder widget.</p><p>To check the remaining UI source code, I’d suggest you take a look at this <a href="https://github.com/Biplab-Dutta/form-validation">repo</a> which contains the source code for the entire project.</p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This article demonstrated how you can perform form validation in Flutter using proper techniques and without having any business logic in the UI. There are several other ways to do the same thing. One of them happens to be <a href="https://pub.dev/packages/formz">formz</a> package.</p><p>I hope after reading this article those who have been writing their validation logic in the UI, would now have such logic in the domain layer, keeping your presentation layer neat.</p><p>If you wish to see some Flutter projects with proper architecture, follow me on <a href="https://github.com/Biplab-Dutta/">GitHub</a>. I am also active on Twitter <a href="https://twitter.com/b_plab98">@b_plab</a> where I tweet about Flutter and Android.</p><p><strong><a href="https://github.com/Biplab-Dutta/form-validation">Source Code</a></strong></p><p><strong>My Socials:</strong></p><div class="table-wrapper"><table><tbody><tr><td><a href="https://github.com/Biplab-Dutta/">GitHub</a><td><a href="https://www.linkedin.com/in/biplab-dutta-43774717a/">LinkedIn</a><td><a href="https://twitter.com/b_plab98">Twitter</a></table></div><p>Until next time, happy coding!!! 👨‍💻</p><p>— Biplab Dutta</p><h2 id="credit"><span class="mr-2">Credit</span><a href="#credit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://dormoshe.io/trending-news/form-validation-in-flutter-16654?utm_source=facebook&amp;utm_campaign=facebook">dormoshe.io</a> for the preview image.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/flutter/'>flutter</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/flutter/" class="post-tag no-text-decoration" >flutter</a> <a href="/tags/dart/" class="post-tag no-text-decoration" >dart</a> <a href="/tags/functional-programming/" class="post-tag no-text-decoration" >functional programming</a> <a href="/tags/either/" class="post-tag no-text-decoration" >either</a> <a href="/tags/flutter-bloc/" class="post-tag no-text-decoration" >flutter_bloc</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Form+Validation+in+Flutter+using+flutter_bloc+and+Functional+Programming+%28Either%29%E2%80%94A+Proper+Way+-+Biplab+Dutta&url=https%3A%2F%2Fbiplabdutta.com.np%2Fposts%2Fform-validation%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Form+Validation+in+Flutter+using+flutter_bloc+and+Functional+Programming+%28Either%29%E2%80%94A+Proper+Way+-+Biplab+Dutta&u=https%3A%2F%2Fbiplabdutta.com.np%2Fposts%2Fform-validation%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fbiplabdutta.com.np%2Fposts%2Fform-validation%2F&text=Form+Validation+in+Flutter+using+flutter_bloc+and+Functional+Programming+%28Either%29%E2%80%94A+Proper+Way+-+Biplab+Dutta" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fbiplabdutta.com.np%2Fposts%2Fform-validation%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/exception-handling/">Exception Handling with Functional Programming in Flutter (Either type)</a><li><a href="/posts/reactive-programming/">A Taste of Reactive Programming in Flutter with RxDart and flutter_bloc</a><li><a href="/posts/form-validation/">Form Validation in Flutter using flutter_bloc and Functional Programming (Either)—A Proper Way</a><li><a href="/posts/product-flavors/">Product Flavors in Flutter—Create admin and non-admin apps with distinct UI with a single codebase</a><li><a href="/posts/theme-switching/">Theme Switching & Persisting in Flutter using cubits and Stream</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dart/">dart</a> <a class="post-tag" href="/tags/flutter/">flutter</a> <a class="post-tag" href="/tags/either/">either</a> <a class="post-tag" href="/tags/flutter-bloc/">flutter_bloc</a> <a class="post-tag" href="/tags/functional-programming/">functional programming</a> <a class="post-tag" href="/tags/stream/">stream</a> <a class="post-tag" href="/tags/build-variants/">build variants</a> <a class="post-tag" href="/tags/code-coverage/">code coverage</a> <a class="post-tag" href="/tags/cubits/">cubits</a> <a class="post-tag" href="/tags/fakes/">fakes</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/exception-handling/"><div class="card-body"> <em class="small" data-ts="1651306500" data-df="ll" > Apr 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Exception Handling with Functional Programming in Flutter (Either type)</h3><div class="text-muted small"><p> Every application needs some data sources to receive the data and display it in the UI. So, it becomes very crucial how we, as developers, perform network requests. Handling API responses in an eff...</p></div></div></a></div><div class="card"> <a href="/posts/theme-switching/"><div class="card-body"> <em class="small" data-ts="1654690500" data-df="ll" > Jun 8, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Theme Switching & Persisting in Flutter using cubits and Stream</h3><div class="text-muted small"><p> Every mobile app user prefers having an option to choose between multiple themes. Having decent themes available is also very crucial in enhancing the user experience. So, how can we do it effectiv...</p></div></div></a></div><div class="card"> <a href="/posts/reactive-programming/"><div class="card-body"> <em class="small" data-ts="1651922100" data-df="ll" > May 7, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>A Taste of Reactive Programming in Flutter with RxDart and flutter_bloc</h3><div class="text-muted small"><p> When it comes to reactive programming, not many developers, especially junior developers feel comfortable with it. The base for reactive programming in Dart is Stream, a type in dart used to repres...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/reactive-programming/" class="btn btn-outline-primary" prompt="Older"><p>A Taste of Reactive Programming in Flutter with RxDart and flutter_bloc</p></a> <a href="/posts/product-flavors/" class="btn btn-outline-primary" prompt="Newer"><p>Product Flavors in Flutter—Create admin and non-admin apps with distinct UI with a single codebase</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://biplabdutta.com.np/posts/form-validation/'; this.page.identifier = '/posts/form-validation/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://personal-blogging-site.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/b_plab98">Biplab Dutta</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dart/">dart</a> <a class="post-tag" href="/tags/flutter/">flutter</a> <a class="post-tag" href="/tags/either/">either</a> <a class="post-tag" href="/tags/flutter-bloc/">flutter_bloc</a> <a class="post-tag" href="/tags/functional-programming/">functional programming</a> <a class="post-tag" href="/tags/stream/">stream</a> <a class="post-tag" href="/tags/build-variants/">build variants</a> <a class="post-tag" href="/tags/code-coverage/">code coverage</a> <a class="post-tag" href="/tags/cubits/">cubits</a> <a class="post-tag" href="/tags/fakes/">fakes</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
