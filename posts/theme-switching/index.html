<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Theme Switching &amp; Persisting in Flutter using cubits and Stream" /><meta name="author" content="Biplab Dutta" /><meta property="og:locale" content="en" /><meta name="description" content="Every mobile app user prefers having an option to choose between multiple themes. Having decent themes available is also very crucial in enhancing the user experience. So, how can we do it effectively in Flutter? How can we have different configs set for each theme? This article ensures that you get a proper understanding of it and I‚Äôll also talk a bit regarding Stream in Dart." /><meta property="og:description" content="Every mobile app user prefers having an option to choose between multiple themes. Having decent themes available is also very crucial in enhancing the user experience. So, how can we do it effectively in Flutter? How can we have different configs set for each theme? This article ensures that you get a proper understanding of it and I‚Äôll also talk a bit regarding Stream in Dart." /><link rel="canonical" href="https://biplabdutta.com.np/posts/theme-switching/" /><meta property="og:url" content="https://biplabdutta.com.np/posts/theme-switching/" /><meta property="og:site_name" content="Biplab Dutta" /><meta property="og:image" content="https://raw.githubusercontent.com/Biplab-Dutta/personal_site/main/preview_images/theme_switching.jpg" /><meta property="og:image:alt" content="Preview Image Credit - raywenderlich.com" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-08T18:00:00+05:45" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://raw.githubusercontent.com/Biplab-Dutta/personal_site/main/preview_images/theme_switching.jpg" /><meta name="twitter:image:alt" content="Preview Image Credit - raywenderlich.com" /><meta property="twitter:title" content="Theme Switching &amp; Persisting in Flutter using cubits and Stream" /><meta name="twitter:site" content="@b_plab98" /><meta name="twitter:creator" content="@b_plab98" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Biplab Dutta","url":"https://twitter.com/b_plab98"},"dateModified":"2022-10-09T19:44:16+05:45","datePublished":"2022-06-08T18:00:00+05:45","description":"Every mobile app user prefers having an option to choose between multiple themes. Having decent themes available is also very crucial in enhancing the user experience. So, how can we do it effectively in Flutter? How can we have different configs set for each theme? This article ensures that you get a proper understanding of it and I‚Äôll also talk a bit regarding Stream in Dart.","headline":"Theme Switching &amp; Persisting in Flutter using cubits and Stream","image":{"alt":"Preview Image Credit - raywenderlich.com","url":"https://raw.githubusercontent.com/Biplab-Dutta/personal_site/main/preview_images/theme_switching.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://biplabdutta.com.np/posts/theme-switching/"},"url":"https://biplabdutta.com.np/posts/theme-switching/"}</script><title>Theme Switching & Persisting in Flutter using cubits and Stream | Biplab Dutta</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Biplab Dutta"><meta name="application-name" content="Biplab Dutta"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/63902683?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Biplab Dutta</a></div><div class="site-subtitle font-italic">Flutter Developer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Biplab-Dutta" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/b_plab98" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/biplab-dutta-43774717a" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://stackoverflow.com/users/10167900/biplab-dutta" aria-label="stack-overflow" target="_blank" rel="noopener"> <i class="fab fa-stack-overflow"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Theme Switching & Persisting in Flutter using cubits and Stream</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Theme Switching & Persisting in Flutter using cubits and Stream</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1654690500" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jun 8, 2022 </em> </span> <span> Updated <em class="" data-ts="1665323956" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 9, 2022 </em> </span><div class="mt-3 mb-3"> <img data-src="https://raw.githubusercontent.com/Biplab-Dutta/personal_site/main/preview_images/theme_switching.jpg" class="preview-img bg" alt="Preview Image Credit - raywenderlich.com" data-proofer-ignore><figcaption class="text-center pt-2 pb-2">Preview Image Credit - raywenderlich.com</figcaption></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/b_plab98">Biplab Dutta</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2100 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><p>Every mobile app user prefers having an option to choose between multiple themes. Having decent themes available is also very crucial in enhancing the user experience. So, how can we do it effectively in Flutter? How can we have different configs set for each theme? This article ensures that you get a proper understanding of it and I‚Äôll also talk a bit regarding <code class="language-plaintext highlighter-rouge">Stream</code> in Dart.</p><h2 id="table-of-contents"><span class="mr-2">Table of Contents</span><a href="#table-of-contents" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="#demo">Demo</a><li><a href="#dependencies">Dependencies</a><li><a href="#lets-code-">Let‚Äôs Code üë®‚Äçüíª</a><ul><li><a href="#theme-configurations">Theme Configurations</a><li><a href="#data-layertheme-repository">Data Layer/Theme Repository</a><li><a href="#cubitsviewmodelstate-management">Cubits/ViewModel/State Management</a><li><a href="#maindart">main.dart</a><li><a href="#app-widget">App Widget</a><li><a href="#homepage">HomePage</a></ul><li><a href="#other-solutions">Other solutions</a><li><a href="#conclusion">Conclusion</a><li><a href="#credit">Credit</a></ul><h2 id="demo"><span class="mr-2">Demo</span><a href="#demo" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Let‚Äôs take a look at our final app.</p><p><img data-src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/bs1jwa9pgp858t2gyiy9.gif" alt="flutter-theme-switching-demo" data-proofer-ignore></p><p>As we can see in the GIF, our app allows us to switch between dark theme and light theme. Also, the icon on the floating action button changes dynamically. And the chosen theme is persisted which can be witnessed in every app launch.</p><h2 id="dependencies"><span class="mr-2">Dependencies</span><a href="#dependencies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Before we begin working on the code, let‚Äôs first include some external packages that we will need. Include <a href="https://pub.dev/packages/flutter_bloc">flutter_bloc</a>, <a href="https://pub.dev/packages/shared_preferences">shared_preferences</a>, and <a href="https://pub.dev/packages/equatable">equatable</a> as your dependencies in <code class="language-plaintext highlighter-rouge">pubspec.yaml</code> file.</p><h2 id="lets-code-"><span class="mr-2">Let‚Äôs Code üë®‚Äçüíª</span><a href="#lets-code-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Since this is a very simple app, I won‚Äôt be concerned about app architecture in this article. You can check my other articles if you want to learn about app architecture.</p><h3 id="theme-configurations"><span class="mr-2">Theme Configurations</span><a href="#theme-configurations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, start a new flutter project and get rid of the default counter app. Then inside the lib folder, create a file <code class="language-plaintext highlighter-rouge">app_theme.dart</code>.</p><div file="app_theme.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="app_theme.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="s">'package:flutter/material.dart'</span><span class="o">;</span>

<span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">AppTheme</span> <span class="p">{</span>
  <span class="kd">static</span> <span class="n">ThemeData</span> <span class="kd">get</span> <span class="n">lightTheme</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">ThemeData</span><span class="p">(</span>
        <span class="nl">scaffoldBackgroundColor:</span> <span class="n">Colors</span><span class="o">.</span><span class="na">white</span><span class="p">,</span>
        <span class="nl">textTheme:</span> <span class="n">ThemeData</span><span class="o">.</span><span class="na">light</span><span class="p">()</span><span class="o">.</span><span class="na">textTheme</span><span class="o">.</span><span class="na">copyWith</span><span class="p">(</span>
              <span class="nl">bodyText1:</span> <span class="kd">const</span> <span class="n">TextStyle</span><span class="p">(</span>
                <span class="nl">fontSize:</span> <span class="mi">25</span><span class="p">,</span>
                <span class="nl">color:</span> <span class="n">Colors</span><span class="o">.</span><span class="na">black</span><span class="p">,</span>
              <span class="p">),</span>
              <span class="nl">caption:</span> <span class="kd">const</span> <span class="n">TextStyle</span><span class="p">(</span>
                <span class="nl">fontStyle:</span> <span class="n">FontStyle</span><span class="o">.</span><span class="na">italic</span><span class="p">,</span>
                <span class="nl">fontSize:</span> <span class="mi">15</span><span class="p">,</span>
                <span class="nl">color:</span> <span class="n">Colors</span><span class="o">.</span><span class="na">black</span><span class="p">,</span>
              <span class="p">),</span>
            <span class="p">),</span>
      <span class="p">);</span>

  <span class="kd">static</span> <span class="n">ThemeData</span> <span class="kd">get</span> <span class="n">darkTheme</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">ThemeData</span><span class="p">(</span>
        <span class="nl">scaffoldBackgroundColor:</span> <span class="n">Colors</span><span class="o">.</span><span class="na">blueGrey</span><span class="o">.</span><span class="na">shade800</span><span class="p">,</span>
        <span class="nl">textTheme:</span> <span class="n">ThemeData</span><span class="o">.</span><span class="na">dark</span><span class="p">()</span><span class="o">.</span><span class="na">textTheme</span><span class="o">.</span><span class="na">copyWith</span><span class="p">(</span>
              <span class="nl">bodyText1:</span> <span class="kd">const</span> <span class="n">TextStyle</span><span class="p">(</span>
                <span class="nl">fontSize:</span> <span class="mi">25</span><span class="p">,</span>
                <span class="nl">color:</span> <span class="n">Colors</span><span class="o">.</span><span class="na">white</span><span class="p">,</span>
              <span class="p">),</span>
              <span class="nl">caption:</span> <span class="kd">const</span> <span class="n">TextStyle</span><span class="p">(</span>
                <span class="nl">fontStyle:</span> <span class="n">FontStyle</span><span class="o">.</span><span class="na">italic</span><span class="p">,</span>
                <span class="nl">fontSize:</span> <span class="mi">15</span><span class="p">,</span>
                <span class="nl">color:</span> <span class="n">Colors</span><span class="o">.</span><span class="na">white</span><span class="p">,</span>
              <span class="p">),</span>
            <span class="p">),</span>
      <span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="data-layertheme-repository"><span class="mr-2">Data Layer/Theme Repository</span><a href="#data-layertheme-repository" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Then create a <code class="language-plaintext highlighter-rouge">theme_repository.dart</code> file inside the lib directory and paste the following code.</p><div file="theme_repository.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="theme_repository.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="s">'package:shared_preferences/shared_preferences.dart'</span><span class="o">;</span>

<span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">ThemePersistence</span> <span class="p">{</span>
  <span class="n">Stream</span><span class="p">&lt;</span><span class="n">CustomTheme</span><span class="p">&gt;</span> <span class="n">getTheme</span><span class="p">();</span>
  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">saveTheme</span><span class="p">(</span><span class="n">CustomTheme</span> <span class="n">theme</span><span class="p">);</span>
  <span class="kt">void</span> <span class="n">dispose</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">enum</span> <span class="n">CustomTheme</span> <span class="p">{</span> <span class="n">light</span><span class="p">,</span> <span class="n">dark</span> <span class="p">}</span>

<span class="kd">class</span> <span class="nc">ThemeRepository</span> <span class="kd">implements</span> <span class="n">ThemePersistence</span> <span class="p">{</span>
  <span class="n">ThemeRepository</span><span class="p">({</span>
    <span class="kd">required</span> <span class="n">SharedPreferences</span> <span class="n">sharedPreferences</span><span class="p">,</span>
  <span class="p">})</span> <span class="o">:</span> <span class="n">_sharedPreferences</span> <span class="o">=</span> <span class="n">sharedPreferences</span><span class="p">;</span>
  
  <span class="kd">final</span> <span class="n">SharedPreferences</span> <span class="n">_sharedPreferences</span><span class="p">;</span>

  <span class="nd">@override</span>
  <span class="n">Stream</span><span class="p">&lt;</span><span class="n">CustomTheme</span><span class="p">&gt;</span> <span class="n">getTheme</span><span class="p">()</span> <span class="p">{}</span>

  <span class="nd">@override</span>
  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">saveTheme</span><span class="p">(</span><span class="n">CustomTheme</span> <span class="n">theme</span><span class="p">)</span> <span class="p">{}</span>

  <span class="nd">@override</span>
  <span class="kt">void</span> <span class="n">dispose</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>As you can see, we created an abstract class <code class="language-plaintext highlighter-rouge">ThemePersistence</code>, and another class <code class="language-plaintext highlighter-rouge">ThemeRepository</code> that implements the abstract class. Also, we created an enum <code class="language-plaintext highlighter-rouge">CustomTheme</code> that has two values ‚Äî <code class="language-plaintext highlighter-rouge">light</code> and <code class="language-plaintext highlighter-rouge">dark</code> because these are the themes that our app will have. The <code class="language-plaintext highlighter-rouge">ThemeRepository</code> class depends on the <code class="language-plaintext highlighter-rouge">SharedPreferences</code> instance that we will use for theme persistence.</p><p>Also, we can see that <code class="language-plaintext highlighter-rouge">getTheme()</code> returns a <code class="language-plaintext highlighter-rouge">Stream</code> and not a <code class="language-plaintext highlighter-rouge">Future</code>. The main reason behind using Stream is that listeners of this Stream can immediately be notified of the theme change and we needn‚Äôt call the <code class="language-plaintext highlighter-rouge">getTheme()</code> method again and again.</p><p>If we had a <code class="language-plaintext highlighter-rouge">Future</code> implementation for <code class="language-plaintext highlighter-rouge">getTheme()</code>, after every theme update, we‚Äôd have to invoke the <code class="language-plaintext highlighter-rouge">getTheme()</code> method which is not ideal.</p><blockquote class="prompt-tip"><div><p><em>getTheme() is a one-time delivery of data meaning that it should be called only once and any changes should be yielded in the form of a stream which the listeners will listen to.</em></p></div></blockquote><p>Now, we will add code to our <code class="language-plaintext highlighter-rouge">getTheme()</code> and <code class="language-plaintext highlighter-rouge">saveTheme()</code> methods.</p><div file="theme_repository.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="theme_repository.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="s">'package:shared_preferences/shared_preferences.dart'</span><span class="o">;</span>

<span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">ThemePersistence</span> <span class="p">{</span>
  <span class="n">Stream</span><span class="p">&lt;</span><span class="n">CustomTheme</span><span class="p">&gt;</span> <span class="n">getTheme</span><span class="p">();</span>
  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">saveTheme</span><span class="p">(</span><span class="n">CustomTheme</span> <span class="n">theme</span><span class="p">);</span>
  <span class="kt">void</span> <span class="n">dispose</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">enum</span> <span class="n">CustomTheme</span> <span class="p">{</span> <span class="n">light</span><span class="p">,</span> <span class="n">dark</span> <span class="p">}</span>

<span class="kd">class</span> <span class="nc">ThemeRepository</span> <span class="kd">implements</span> <span class="n">ThemePersistence</span> <span class="p">{</span>
  <span class="n">ThemeRepository</span><span class="p">({</span>
    <span class="kd">required</span> <span class="n">SharedPreferences</span> <span class="n">sharedPreferences</span><span class="p">,</span>
  <span class="p">})</span> <span class="o">:</span> <span class="n">_sharedPreferences</span> <span class="o">=</span> <span class="n">sharedPreferences</span><span class="p">;</span>

  <span class="kd">final</span> <span class="n">SharedPreferences</span> <span class="n">_sharedPreferences</span><span class="p">;</span>

  <span class="kd">static</span> <span class="kd">const</span> <span class="n">_kThemePersistenceKey</span> <span class="o">=</span> <span class="s">'__theme_persistence_key__'</span><span class="p">;</span>

  <span class="kd">final</span> <span class="n">_controller</span> <span class="o">=</span> <span class="n">StreamController</span><span class="p">&lt;</span><span class="n">CustomTheme</span><span class="p">&gt;();</span>

  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">_setValue</span><span class="p">(</span><span class="kt">String</span> <span class="n">key</span><span class="p">,</span> <span class="kt">String</span> <span class="n">value</span><span class="p">)</span> <span class="o">=</span><span class="p">&gt;</span>
      <span class="n">_sharedPreferences</span><span class="o">.</span><span class="na">setString</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>

  <span class="nd">@override</span>
  <span class="n">Stream</span><span class="p">&lt;</span><span class="n">CustomTheme</span><span class="p">&gt;</span> <span class="n">getTheme</span><span class="p">()</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">_controller</span><span class="o">.</span><span class="na">stream</span><span class="p">;</span>

  <span class="nd">@override</span>
  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">saveTheme</span><span class="p">(</span><span class="n">CustomTheme</span> <span class="n">theme</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">_controller</span><span class="o">.</span><span class="na">add</span><span class="p">(</span><span class="n">theme</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">_setValue</span><span class="p">(</span><span class="n">_kThemePersistenceKey</span><span class="p">,</span> <span class="n">theme</span><span class="o">.</span><span class="na">name</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nd">@override</span>
  <span class="kt">void</span> <span class="n">dispose</span><span class="p">()</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">_controller</span><span class="o">.</span><span class="na">close</span><span class="p">();</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We initialized a <code class="language-plaintext highlighter-rouge">StreamController</code> which will act as a manager for our <code class="language-plaintext highlighter-rouge">Stream&lt;CustomTheme&gt;</code>. The <code class="language-plaintext highlighter-rouge">saveTheme()</code> method is straightforward. First, it adds the theme that we want to save to the stream and then calls <code class="language-plaintext highlighter-rouge">_setValue()</code> which will persist the theme. The <code class="language-plaintext highlighter-rouge">_setValue()</code> method uses API from <code class="language-plaintext highlighter-rouge">SharedPreferences</code> to persist the chosen theme.</p><p>Everything looks fine. But if you see it carefully, the method <code class="language-plaintext highlighter-rouge">getTheme()</code> yields the stream from the controller. But initially, as the app is launched, there would be no stream in the controller. Then how do we deal with it?</p><p>The solution is simple. We can add a constructor body that would be executed as soon as the <code class="language-plaintext highlighter-rouge">ThemeRepository</code> class is instantiated. Also, <code class="language-plaintext highlighter-rouge">getTheme()</code> is a method that would be called in the very early stage. So, we need to make sure that before the <code class="language-plaintext highlighter-rouge">getTheme()</code> method is called, there is some stream value in the controller. So, add a <code class="language-plaintext highlighter-rouge">_init()</code> method in the constructor body and instantiate the <code class="language-plaintext highlighter-rouge">ThemeRepository</code> in the <code class="language-plaintext highlighter-rouge">main.dart</code> file later. Then, the final version of our <code class="language-plaintext highlighter-rouge">theme_repository.dart</code> file would look like this:</p><div file="theme_repository.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="theme_repository.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="s">'dart:async'</span><span class="o">;</span>

<span class="kn">import</span> <span class="s">'package:shared_preferences/shared_preferences.dart'</span><span class="o">;</span>

<span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">ThemePersistence</span> <span class="p">{</span>
  <span class="n">Stream</span><span class="p">&lt;</span><span class="n">CustomTheme</span><span class="p">&gt;</span> <span class="n">getTheme</span><span class="p">();</span>
  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">saveTheme</span><span class="p">(</span><span class="n">CustomTheme</span> <span class="n">theme</span><span class="p">);</span>
  <span class="kt">void</span> <span class="n">dispose</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">enum</span> <span class="n">CustomTheme</span> <span class="p">{</span> <span class="n">light</span><span class="p">,</span> <span class="n">dark</span> <span class="p">}</span>

<span class="kd">class</span> <span class="nc">ThemeRepository</span> <span class="kd">implements</span> <span class="n">ThemePersistence</span> <span class="p">{</span>
  <span class="n">ThemeRepository</span><span class="p">({</span>
    <span class="kd">required</span> <span class="n">SharedPreferences</span> <span class="n">sharedPreferences</span><span class="p">,</span>
  <span class="p">})</span> <span class="o">:</span> <span class="n">_sharedPreferences</span> <span class="o">=</span> <span class="n">sharedPreferences</span> <span class="p">{</span>
    <span class="n">_init</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="kd">final</span> <span class="n">SharedPreferences</span> <span class="n">_sharedPreferences</span><span class="p">;</span>

  <span class="kd">static</span> <span class="kd">const</span> <span class="n">_kThemePersistenceKey</span> <span class="o">=</span> <span class="s">'__theme_persistence_key__'</span><span class="p">;</span>

  <span class="kd">final</span> <span class="n">_controller</span> <span class="o">=</span> <span class="n">StreamController</span><span class="p">&lt;</span><span class="n">CustomTheme</span><span class="p">&gt;();</span>

  <span class="kt">String</span><span class="o">?</span> <span class="n">_getValue</span><span class="p">(</span><span class="kt">String</span> <span class="n">key</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">try</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">_sharedPreferences</span><span class="o">.</span><span class="na">getString</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">_setValue</span><span class="p">(</span><span class="kt">String</span> <span class="n">key</span><span class="p">,</span> <span class="kt">String</span> <span class="n">value</span><span class="p">)</span> <span class="o">=</span><span class="p">&gt;</span>
      <span class="n">_sharedPreferences</span><span class="o">.</span><span class="na">setString</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>

  <span class="kt">void</span> <span class="n">_init</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">final</span> <span class="n">themeString</span> <span class="o">=</span> <span class="n">_getValue</span><span class="p">(</span><span class="n">_kThemePersistenceKey</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">themeString</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">themeString</span> <span class="o">==</span> <span class="n">CustomTheme</span><span class="o">.</span><span class="na">light</span><span class="o">.</span><span class="na">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">_controller</span><span class="o">.</span><span class="na">add</span><span class="p">(</span><span class="n">CustomTheme</span><span class="o">.</span><span class="na">light</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">_controller</span><span class="o">.</span><span class="na">add</span><span class="p">(</span><span class="n">CustomTheme</span><span class="o">.</span><span class="na">dark</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">_controller</span><span class="o">.</span><span class="na">add</span><span class="p">(</span><span class="n">CustomTheme</span><span class="o">.</span><span class="na">light</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nd">@override</span>
  <span class="n">Stream</span><span class="p">&lt;</span><span class="n">CustomTheme</span><span class="p">&gt;</span> <span class="n">getTheme</span><span class="p">()</span> <span class="kd">async</span><span class="o">*</span> <span class="p">{</span>
    <span class="k">yield</span><span class="o">*</span> <span class="n">_controller</span><span class="o">.</span><span class="na">stream</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nd">@override</span>
  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">saveTheme</span><span class="p">(</span><span class="n">CustomTheme</span> <span class="n">theme</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">_controller</span><span class="o">.</span><span class="na">add</span><span class="p">(</span><span class="n">theme</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">_setValue</span><span class="p">(</span><span class="n">_kThemePersistenceKey</span><span class="p">,</span> <span class="n">theme</span><span class="o">.</span><span class="na">name</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nd">@override</span>
  <span class="kt">void</span> <span class="n">dispose</span><span class="p">()</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">_controller</span><span class="o">.</span><span class="na">close</span><span class="p">();</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Also, you may have noticed I used a <code class="language-plaintext highlighter-rouge">CustomTheme</code> enum that I created in this file instead of using <code class="language-plaintext highlighter-rouge">ThemeMode</code> which is available in Flutter. The reason is simply to avoid including the material package in the data layer of our project as <code class="language-plaintext highlighter-rouge">ThemeMode</code> comes from the material package. In my opinion, the components of the material package are associated with the presentation layer and not the data layer.</p><h3 id="cubitsviewmodelstate-management"><span class="mr-2">Cubits/ViewModel/State Management</span><a href="#cubitsviewmodelstate-management" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now, we will create a <code class="language-plaintext highlighter-rouge">ThemeCubit</code> and <code class="language-plaintext highlighter-rouge">ThemeClass</code> class that will be responsible for our state handling. Create a folder in the lib directory and name it <code class="language-plaintext highlighter-rouge">them_cubit</code>. Inside <code class="language-plaintext highlighter-rouge">theme_cubit</code>, create two dart files ‚Äî <code class="language-plaintext highlighter-rouge">theme_cubit.dart</code> and <code class="language-plaintext highlighter-rouge">theme_state.dart</code>.</p><div file="theme_state.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="theme_state.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>
<span class="kn">part of</span> <span class="s">'theme_cubit.dart'</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">ThemeState</span> <span class="kd">extends</span> <span class="n">Equatable</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="n">ThemeState</span><span class="p">({</span><span class="k">this</span><span class="o">.</span><span class="na">themeMode</span> <span class="o">=</span> <span class="n">ThemeMode</span><span class="o">.</span><span class="na">light</span><span class="p">});</span> <span class="c1">// Default theme = light theme</span>

  <span class="kd">final</span> <span class="n">ThemeMode</span> <span class="n">themeMode</span><span class="p">;</span>

  <span class="c1">// `copyWith()` method allows us to emit brand new instance of ThemeState</span>
  <span class="n">ThemeState</span> <span class="n">copyWith</span><span class="p">({</span><span class="n">ThemeMode</span><span class="o">?</span> <span class="n">themeMode</span><span class="p">})</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">ThemeState</span><span class="p">(</span>
        <span class="nl">themeMode:</span> <span class="n">themeMode</span> <span class="o">??</span> <span class="k">this</span><span class="o">.</span><span class="na">themeMode</span><span class="p">,</span>
      <span class="p">);</span>

  <span class="nd">@override</span>
  <span class="kt">List</span><span class="p">&lt;</span><span class="kt">Object</span><span class="o">?</span><span class="p">&gt;</span> <span class="kd">get</span> <span class="n">props</span> <span class="o">=</span><span class="p">&gt;</span> <span class="p">[</span><span class="n">themeMode</span><span class="p">];</span>
<span class="p">}</span>
</pre></table></code></div></div><div file="theme_cubit.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="theme_cubit.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="s">'dart:async'</span><span class="o">;</span>

<span class="kn">import</span> <span class="s">'package:equatable/equatable.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:flutter/material.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:flutter_bloc/flutter_bloc.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:theme_switching_demo/theme_repository.dart'</span><span class="o">;</span>

<span class="kn">part</span> <span class="s">'theme_state.dart'</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">ThemeCubit</span> <span class="kd">extends</span> <span class="n">Cubit</span><span class="p">&lt;</span><span class="n">ThemeState</span><span class="p">&gt;</span> <span class="p">{</span>
  <span class="n">ThemeCubit</span><span class="p">({</span>
    <span class="kd">required</span> <span class="n">ThemePersistence</span> <span class="n">themeRepository</span><span class="p">,</span>
  <span class="p">})</span>  <span class="o">:</span> <span class="n">_themeRepository</span> <span class="o">=</span> <span class="n">themeRepository</span><span class="p">,</span>
        <span class="k">super</span><span class="p">(</span><span class="kd">const</span> <span class="n">ThemeState</span><span class="p">());</span>

  <span class="kd">final</span> <span class="n">ThemePersistence</span> <span class="n">_themeRepository</span><span class="p">;</span>
  <span class="kd">late</span> <span class="n">StreamSubscription</span><span class="p">&lt;</span><span class="n">CustomTheme</span><span class="p">&gt;</span> <span class="n">_themeSubscription</span><span class="p">;</span>
  <span class="kd">static</span> <span class="kd">late</span> <span class="kt">bool</span> <span class="n">_isDarkTheme</span><span class="p">;</span>  <span class="c1">// used to determine if the current theme is dark</span>

  <span class="kt">void</span> <span class="n">getCurrentTheme</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Since `getTheme()` returns a stream, we listen to the output</span>
    <span class="n">_themeSubscription</span> <span class="o">=</span> <span class="n">_themeRepository</span><span class="o">.</span><span class="na">getTheme</span><span class="p">()</span><span class="o">.</span><span class="na">listen</span><span class="p">(</span>
      <span class="p">(</span><span class="n">customTheme</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">customTheme</span><span class="o">.</span><span class="na">name</span> <span class="o">==</span> <span class="n">CustomTheme</span><span class="o">.</span><span class="na">light</span><span class="o">.</span><span class="na">name</span><span class="p">)</span> <span class="p">{</span>
          <span class="c1">// Since, `customTheme` is light, we set `_isDarkTheme` to false</span>
          <span class="n">_isDarkTheme</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="n">emit</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="na">copyWith</span><span class="p">(</span><span class="nl">themeMode:</span> <span class="n">ThemeMode</span><span class="o">.</span><span class="na">light</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="c1">// Since, `customTheme` is dark, we set `_isDarkTheme` to true</span>
          <span class="n">_isDarkTheme</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
          <span class="n">emit</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="na">copyWith</span><span class="p">(</span><span class="nl">themeMode:</span> <span class="n">ThemeMode</span><span class="o">.</span><span class="na">dark</span><span class="p">));</span>
        <span class="p">}</span>
      <span class="p">},</span>
    <span class="p">);</span>
  <span class="p">}</span>

  <span class="kt">void</span> <span class="n">switchTheme</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">_isDarkTheme</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// Since, currentTheme is dark, after switching we want light theme to</span>
      <span class="c1">// be persisted.</span>
      <span class="n">_themeRepository</span><span class="o">.</span><span class="na">saveTheme</span><span class="p">(</span><span class="n">CustomTheme</span><span class="o">.</span><span class="na">light</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="c1">// Since, currentTheme is light, after switching we want dark theme to</span>
      <span class="c1">// be persisted.</span>
      <span class="n">_themeRepository</span><span class="o">.</span><span class="na">saveTheme</span><span class="p">(</span><span class="n">CustomTheme</span><span class="o">.</span><span class="na">dark</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="nd">@override</span>
  <span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">close</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">_themeSubscription</span><span class="o">.</span><span class="na">cancel</span><span class="p">();</span>
    <span class="n">_themeRepository</span><span class="o">.</span><span class="na">dispose</span><span class="p">();</span>
    <span class="k">return</span> <span class="k">super</span><span class="o">.</span><span class="na">close</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The code is self-explanatory and I have added all the necessary explanations through comments in the above code. Be sure to go through them.</p><h3 id="maindart"><span class="mr-2">main.dart</span><a href="#maindart" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Let‚Äôs add some code to the <code class="language-plaintext highlighter-rouge">main.dart</code> file.</p><div file="main.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="main.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="s">'package:flutter/material.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:shared_preferences/shared_preferences.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:theme_switching_demo/app.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:theme_switching_demo/theme_repository.dart'</span><span class="o">;</span>

<span class="n">Future</span><span class="p">&lt;</span><span class="kt">void</span><span class="p">&gt;</span> <span class="n">main</span><span class="p">()</span> <span class="kd">async</span> <span class="p">{</span>
  <span class="c1">// required when using any plugin. In our case, it's shared_preferences</span>
  <span class="n">WidgetsFlutterBinding</span><span class="o">.</span><span class="na">ensureInitialized</span><span class="p">();</span>
  
  <span class="c1">// Creating an instance of ThemeRepository that will invoke the `_init()` method</span>
  <span class="c1">// and populate the stream controller in the repository.</span>
  <span class="kd">final</span> <span class="n">themeRepository</span> <span class="o">=</span> <span class="n">ThemeRepository</span><span class="p">(</span>
    <span class="nl">sharedPreferences:</span> <span class="k">await</span> <span class="n">SharedPreferences</span><span class="o">.</span><span class="na">getInstance</span><span class="p">(),</span>
  <span class="p">);</span>
  
  <span class="n">runApp</span><span class="p">(</span><span class="n">App</span><span class="p">(</span><span class="nl">themeRepository:</span> <span class="n">themeRepository</span><span class="p">));</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="app-widget"><span class="mr-2">App Widget</span><a href="#app-widget" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Next, create a <code class="language-plaintext highlighter-rouge">app.dart</code> file in the lib directory and paste the following code.</p><div file="app.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="app.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="s">'package:flutter/material.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:flutter_bloc/flutter_bloc.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:theme_switching_demo/home_page.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:theme_switching_demo/theme_cubit/theme_cubit.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:theme_switching_demo/theme_repository.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:theme_switching_demo/themes.dart'</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">App</span> <span class="kd">extends</span> <span class="n">StatelessWidget</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="n">App</span><span class="p">({</span><span class="kd">required</span> <span class="k">this</span><span class="o">.</span><span class="na">themeRepository</span><span class="p">,</span> <span class="k">super</span><span class="o">.</span><span class="na">key</span><span class="p">});</span>

  <span class="kd">final</span> <span class="n">ThemeRepository</span> <span class="n">themeRepository</span><span class="p">;</span>

  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">RepositoryProvider</span><span class="o">.</span><span class="na">value</span><span class="p">(</span>
      <span class="nl">value:</span> <span class="n">themeRepository</span><span class="p">,</span>
      <span class="nl">child:</span> <span class="n">BlocProvider</span><span class="p">(</span>
        <span class="nl">create:</span> <span class="p">(</span><span class="n">context</span><span class="p">)</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">ThemeCubit</span><span class="p">(</span>
          <span class="nl">themeRepository:</span> <span class="n">context</span><span class="o">.</span><span class="na">read</span><span class="p">&lt;</span><span class="n">ThemeRepository</span><span class="p">&gt;(),</span>
        <span class="p">).</span><span class="o">.</span><span class="na">getCurrentTheme</span><span class="p">(),</span>
        <span class="nl">child:</span> <span class="kd">const</span> <span class="n">AppView</span><span class="p">(),</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">AppView</span> <span class="kd">extends</span> <span class="n">StatelessWidget</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="n">AppView</span><span class="p">({</span><span class="k">super</span><span class="o">.</span><span class="na">key</span><span class="p">});</span>

  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">BlocBuilder</span><span class="p">&lt;</span><span class="n">ThemeCubit</span><span class="p">,</span> <span class="n">ThemeState</span><span class="p">&gt;(</span>
      <span class="nl">builder:</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">MaterialApp</span><span class="p">(</span>
          <span class="nl">debugShowCheckedModeBanner:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="nl">title:</span> <span class="s">'Flutter Demo'</span><span class="p">,</span>
          <span class="nl">theme:</span> <span class="n">AppTheme</span><span class="o">.</span><span class="na">lightTheme</span><span class="p">,</span> <span class="c1">// If ThemeMode is ThemeMode.light, this is selected as app's theme</span>
          <span class="nl">darkTheme:</span> <span class="n">AppTheme</span><span class="o">.</span><span class="na">darkTheme</span><span class="p">,</span> <span class="c1">// If ThemeMode is ThemeMode.dark, this is selected as app's theme</span>
          
          <span class="c1">// The themeMode is the most important property in showing</span>
          <span class="c1">// proper theme. The value comes from ThemeState class.</span>
          <span class="nl">themeMode:</span> <span class="n">state</span><span class="o">.</span><span class="na">themeMode</span><span class="p">,</span>
          <span class="nl">home:</span> <span class="kd">const</span> <span class="n">HomePage</span><span class="p">(),</span>
        <span class="p">);</span>
      <span class="p">},</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="homepage"><span class="mr-2">HomePage</span><a href="#homepage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Create a file <code class="language-plaintext highlighter-rouge">home_page.dart</code> and add the following code.</p><div file="home_page.dart" class="language-dart highlighter-rouge"><div class="code-header"> <span data-label-text="home_page.dart"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="s">'package:flutter/material.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:flutter_bloc/flutter_bloc.dart'</span><span class="o">;</span>
<span class="kn">import</span> <span class="s">'package:theme_switching_demo/theme_cubit/theme_cubit.dart'</span><span class="o">;</span>

<span class="kd">class</span> <span class="nc">HomePage</span> <span class="kd">extends</span> <span class="n">StatelessWidget</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="n">HomePage</span><span class="p">({</span><span class="k">super</span><span class="o">.</span><span class="na">key</span><span class="p">});</span>

  <span class="nd">@override</span>
  <span class="n">Widget</span> <span class="n">build</span><span class="p">(</span><span class="n">BuildContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">Scaffold</span><span class="p">(</span>
      <span class="nl">appBar:</span> <span class="n">AppBar</span><span class="p">(</span>
        <span class="nl">title:</span> <span class="kd">const</span> <span class="n">Text</span><span class="p">(</span><span class="s">'Theme Switching Demo'</span><span class="p">),</span>
      <span class="p">),</span>
      <span class="nl">body:</span> <span class="n">Center</span><span class="p">(</span>
        <span class="nl">child:</span> <span class="n">Column</span><span class="p">(</span>
          <span class="nl">mainAxisAlignment:</span> <span class="n">MainAxisAlignment</span><span class="o">.</span><span class="na">center</span><span class="p">,</span>
          <span class="nl">children:</span> <span class="p">[</span>
            <span class="n">Text</span><span class="p">(</span>
              <span class="s">'Follow me on my socials'</span><span class="p">,</span>
              <span class="nl">style:</span> <span class="n">Theme</span><span class="o">.</span><span class="na">of</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="na">textTheme</span><span class="o">.</span><span class="na">bodyText1</span><span class="p">,</span>
              <span class="c1">// Depending on the current theme, the text is also rendered properly</span>
              <span class="c1">// If the theme is dark, text is white in color else black</span>
            <span class="p">),</span>
            <span class="kd">const</span> <span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">Text</span><span class="p">(</span>
              <span class="s">'https://github.com/Biplab-Dutta'</span><span class="p">,</span>
              <span class="nl">style:</span> <span class="n">Theme</span><span class="o">.</span><span class="na">of</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="na">textTheme</span><span class="o">.</span><span class="na">caption</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="kd">const</span> <span class="n">SizedBox</span><span class="p">(</span><span class="nl">height:</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">Text</span><span class="p">(</span>
              <span class="s">'https://twitter.com/b_plab98'</span><span class="p">,</span>
              <span class="nl">style:</span> <span class="n">Theme</span><span class="o">.</span><span class="na">of</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="na">textTheme</span><span class="o">.</span><span class="na">caption</span><span class="p">,</span>
            <span class="p">),</span>
          <span class="p">],</span>
        <span class="p">),</span>
      <span class="p">),</span>
      <span class="nl">floatingActionButton:</span> <span class="n">FloatingActionButton</span><span class="p">(</span>
        <span class="nl">onPressed:</span> <span class="p">()</span> <span class="o">=</span><span class="p">&gt;</span> <span class="n">context</span><span class="o">.</span><span class="na">read</span><span class="p">&lt;</span><span class="n">ThemeCubit</span><span class="p">&gt;()</span><span class="o">.</span><span class="na">switchTheme</span><span class="p">(),</span>
        <span class="nl">tooltip:</span> <span class="s">'Switch Theme'</span><span class="p">,</span>
        <span class="nl">child:</span> <span class="n">context</span><span class="o">.</span><span class="na">read</span><span class="p">&lt;</span><span class="n">ThemeCubit</span><span class="p">&gt;()</span><span class="o">.</span><span class="na">state</span><span class="o">.</span><span class="na">themeMode</span> <span class="o">==</span> <span class="n">ThemeMode</span><span class="o">.</span><span class="na">light</span>
            <span class="o">?</span> <span class="kd">const</span> <span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="o">.</span><span class="na">dark_mode</span><span class="p">)</span>
            <span class="o">:</span> <span class="kd">const</span> <span class="n">Icon</span><span class="p">(</span><span class="n">Icons</span><span class="o">.</span><span class="na">light_mode</span><span class="p">),</span>
      <span class="p">),</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="other-solutions"><span class="mr-2">Other solutions</span><a href="#other-solutions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There are many other ways of doing the same thing that I showed in this article. You could also use <a href="https://pub.dev/packages/hydrated_bloc">hydrated_bloc</a> instead of cubits to manage the state and persist it. However, I wanted to show you how you could have done the persisting if you were working with other state management solutions other than flutter_bloc.</p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This article showed how we can include theme switching and persisting feature in our Flutter app using the best practices. I hope you all got to learn from my article and if there‚Äôs any feedback for me, drop a comment. I‚Äôll be sure to upload another article in a few days again.</p><p>If you wish to see some Flutter projects with proper architecture, follow me on <a href="https://github.com/Biplab-Dutta">GitHub</a>. I am also active on Twitter <a href="https://twitter.com/b_plab98">@b_plab</a> where I tweet about Flutter and Android.</p><p><strong><a href="https://github.com/Biplab-Dutta/flutter_theme_switcher">Source Code for the project in this article</a></strong></p><p><strong>My Socials:</strong></p><div class="table-wrapper"><table><tbody><tr><td><a href="https://github.com/Biplab-Dutta">GitHub</a><td><a href="https://www.linkedin.com/in/biplab-dutta-43774717a/">LinkedIn</a><td><a href="https://twitter.com/b_plab98">Twitter</a></table></div><p>Until next time, happy coding!!! üë®‚Äçüíª</p><p>‚Äî Biplab Dutta</p><h2 id="credit"><span class="mr-2">Credit</span><a href="#credit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://www.raywenderlich.com/16628777-theming-a-flutter-app-getting-started">raywenderlich.com</a> for the preview image.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/flutter/'>flutter</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/flutter/" class="post-tag no-text-decoration" >flutter</a> <a href="/tags/dart/" class="post-tag no-text-decoration" >dart</a> <a href="/tags/flutter-bloc/" class="post-tag no-text-decoration" >flutter_bloc</a> <a href="/tags/stream/" class="post-tag no-text-decoration" >stream</a> <a href="/tags/cubits/" class="post-tag no-text-decoration" >cubits</a> <a href="/tags/themes/" class="post-tag no-text-decoration" >themes</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Theme+Switching+%26+Persisting+in+Flutter+using+cubits+and+Stream+-+Biplab+Dutta&url=https%3A%2F%2Fbiplabdutta.com.np%2Fposts%2Ftheme-switching%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Theme+Switching+%26+Persisting+in+Flutter+using+cubits+and+Stream+-+Biplab+Dutta&u=https%3A%2F%2Fbiplabdutta.com.np%2Fposts%2Ftheme-switching%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fbiplabdutta.com.np%2Fposts%2Ftheme-switching%2F&text=Theme+Switching+%26+Persisting+in+Flutter+using+cubits+and+Stream+-+Biplab+Dutta" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fbiplabdutta.com.np%2Fposts%2Ftheme-switching%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/exception-handling/">Exception Handling with Functional Programming in Flutter (Either type)</a><li><a href="/posts/reactive-programming/">A Taste of Reactive Programming in Flutter with RxDart and flutter_bloc</a><li><a href="/posts/form-validation/">Form Validation in Flutter using flutter_bloc and Functional Programming (Either)‚ÄîA Proper Way</a><li><a href="/posts/product-flavors/">Product Flavors in Flutter‚ÄîCreate admin and non-admin apps with distinct UI with a single codebase</a><li><a href="/posts/theme-switching/">Theme Switching & Persisting in Flutter using cubits and Stream</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dart/">dart</a> <a class="post-tag" href="/tags/flutter/">flutter</a> <a class="post-tag" href="/tags/either/">either</a> <a class="post-tag" href="/tags/flutter-bloc/">flutter_bloc</a> <a class="post-tag" href="/tags/functional-programming/">functional programming</a> <a class="post-tag" href="/tags/stream/">stream</a> <a class="post-tag" href="/tags/build-variants/">build variants</a> <a class="post-tag" href="/tags/code-coverage/">code coverage</a> <a class="post-tag" href="/tags/cubits/">cubits</a> <a class="post-tag" href="/tags/fakes/">fakes</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/reactive-programming/"><div class="card-body"> <em class="small" data-ts="1651922100" data-df="ll" > May 7, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>A Taste of Reactive Programming in Flutter with RxDart and flutter_bloc</h3><div class="text-muted small"><p> When it comes to reactive programming, not many developers, especially junior developers feel comfortable with it. The base for reactive programming in Dart is Stream, a type in dart used to repres...</p></div></div></a></div><div class="card"> <a href="/posts/form-validation/"><div class="card-body"> <em class="small" data-ts="1652606100" data-df="ll" > May 15, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Form Validation in Flutter using flutter_bloc and Functional Programming (Either)‚ÄîA Proper Way</h3><div class="text-muted small"><p> Dealing with forms is a very common task that we encounter as mobile application developers. With forms come form validation. It is necessary to show relevant warnings to the users when they don‚Äôt ...</p></div></div></a></div><div class="card"> <a href="/posts/exception-handling/"><div class="card-body"> <em class="small" data-ts="1651306500" data-df="ll" > Apr 30, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Exception Handling with Functional Programming in Flutter (Either type)</h3><div class="text-muted small"><p> Every application needs some data sources to receive the data and display it in the UI. So, it becomes very crucial how we, as developers, perform network requests. Handling API responses in an eff...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/product-flavors/" class="btn btn-outline-primary" prompt="Older"><p>Product Flavors in Flutter‚ÄîCreate admin and non-admin apps with distinct UI with a single codebase</p></a> <a href="/posts/unit-test/" class="btn btn-outline-primary" prompt="Newer"><p>A deep dive into unit testing in Flutter üß™</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://biplabdutta.com.np/posts/theme-switching/'; this.page.identifier = '/posts/theme-switching/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://personal-blogging-site.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> ¬© 2022 <a href="https://twitter.com/b_plab98">Biplab Dutta</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/dart/">dart</a> <a class="post-tag" href="/tags/flutter/">flutter</a> <a class="post-tag" href="/tags/either/">either</a> <a class="post-tag" href="/tags/flutter-bloc/">flutter_bloc</a> <a class="post-tag" href="/tags/functional-programming/">functional programming</a> <a class="post-tag" href="/tags/stream/">stream</a> <a class="post-tag" href="/tags/build-variants/">build variants</a> <a class="post-tag" href="/tags/code-coverage/">code coverage</a> <a class="post-tag" href="/tags/cubits/">cubits</a> <a class="post-tag" href="/tags/fakes/">fakes</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
